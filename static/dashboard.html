<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Dashboard — MEDCARE</title><link rel="stylesheet" href="/static/styles.css"><script src="https://cdn.jsdelivr.net/npm/chart.js"></script></head><body><div class="container"><div class="header"><div style="display:flex;gap:12px;align-items:center"><div class="logo"></div><div><strong>MEDCARE</strong><div class="small">Dashboard</div></div></div><div><a href="/login.html" class="small">Switch</a></div></div><div class="grid"><div class="card"><h3>Latest Stress Score</h3><div id="latest" class="small">Loading...</div></div><div class="card"><h3>Quick Actions</h3><div style="display:flex;gap:8px;flex-wrap:wrap"><a class="btn" href="/assessment.html">Take Assessment</a><a class="btn-outline" href="/chatbot/index.html">Chat</a><a class="btn-outline" href="/music.html">Music</a></div></div></div><div class="card" style="margin-top:16px"><h3>Progress Over Time</h3><canvas id="historyChart" style="max-height:300px"></canvas></div><div class="card" style="margin-top:16px"><h3>Personalized Summary</h3><div id="plan" class="small">Loading...</div></div><div class="footer small">Tip: take assessments every 1–2 weeks to track trends.</div></div><script>async function loadDashboard(){ const uid=localStorage.getItem('medcare_user')||'demo_user'; const res=await fetch('/api/user/'+uid+'/history'); const data=await res.json(); if(!data||data.length===0){document.getElementById('latest').innerText='No assessments yet'; return;} const latest=data[0]; document.getElementById('latest').innerText=latest.score + ' ('+latest.label+') • ' + new Date(latest.ts).toLocaleString(); const labels=data.map(r=>new Date(r.ts).toLocaleDateString()).reverse(); const scores=data.map(r=>r.score).reverse(); new Chart(document.getElementById('historyChart'),{type:'line',data:{labels:labels,datasets:[{label:'Stress Score',data:scores,borderColor:'#2d7f88',tension:0.3}]}}); // fetch summarized plan via LLM endpoint
try{ const s = await fetch('/summarize_assessment',{method:'POST',headers:{'Content-Type':'application/json'},body: JSON.stringify({user_id:uid})}); if(s.ok){ const j=await s.json(); document.getElementById('plan').innerText=j.plan; } }catch(e){ console.log('Plan fetch failed',e); } } loadDashboard();</script></body></html>
